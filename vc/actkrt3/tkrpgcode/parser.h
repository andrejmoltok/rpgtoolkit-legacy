///////////////////////////////////////////////////////////////////////////
//All contents copyright 2004, Colin James Fitzpatrick (KSNiloc)
//All rights reserved.  YOU MAY NOT REMOVE THIS NOTICE.
//Read LICENSE.txt for licensing info
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
// RPGCode Parser
///////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////
// Inclusions
//////////////////////////////////////////////////////////////////////////
#define WIN32_LEAN_AND_MEAN					//no MFC
#include <windows.h>						//include windows API
#include "..\inlineString\inlineString.h"	//for strings
#include <wtypes.h>							//for VB strings
#include <oleauto.h>						//for BSTR API

//////////////////////////////////////////////////////////////////////////
// Definitions
//////////////////////////////////////////////////////////////////////////
#define TAB "	"							//the tab key

//////////////////////////////////////////////////////////////////////////
// Types
//////////////////////////////////////////////////////////////////////////
typedef void (__stdcall* CBOneParamStr)(BSTR);

//////////////////////////////////////////////////////////////////////////
// Prototypes
//////////////////////////////////////////////////////////////////////////

//for vb strings
inline void initVbString(char* theString);
inline void returnVbString(inlineString theString);

//for BSTRs
inline BSTR Char2BSTR(char* stringPointer);

//exports
void APIENTRY RPGCInitParser(int setStringAddress);
void APIENTRY RPGCGetMethodName(char* pText);
void APIENTRY RPGCParseAfter(char* pText, char* startSymbol);
void APIENTRY RPGCParseBefore(char* pText, char* startSymbol);